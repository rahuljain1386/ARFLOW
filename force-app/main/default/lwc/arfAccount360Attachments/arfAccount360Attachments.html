<template>
    <div class="attach-container">
        <!-- Header -->
        <div class="attach-header">
            <p class="slds-text-body_small slds-align-middle">{cardTitle}</p>
            <div class="attach-header-actions">
                <lightning-file-upload
                    label="Upload Files"
                    name="accountFiles"
                    accept={acceptedFormats}
                    record-id={recordId}
                    onuploadfinished={handleUploadFinished}
                    multiple>
                </lightning-file-upload>
            </div>
        </div>

        <!-- File Grid -->
        <template lwc:if={hasData}>
            <div class="attach-grid">
                <template for:each={attachments} for:item="file">
                    <a key={file.documentId} href={file.downloadUrl} target="_blank" class="file-card">
                        <div class="file-icon-wrap">
                            <lightning-icon icon-name={file.iconName} size="medium"></lightning-icon>
                        </div>
                        <div class="file-info">
                            <p class="file-name" title={file.title}>{file.title}</p>
                            <p class="file-meta">
                                <span class="file-ext">{file.extension}</span>
                                <span class="file-size">{file.sizeLabel}</span>
                            </p>
                            <p class="file-source" title={file.sourceLabel}>{file.sourceLabel}</p>
                            <p class="file-date">{file.formattedDate}</p>
                        </div>
                    </a>
                </template>
            </div>
        </template>
        <template lwc:elseif={error}>
            <p class="slds-text-color_error slds-p-around_medium">Error loading attachments.</p>
        </template>
        <template lwc:else>
            <div class="slds-align_absolute-center slds-p-around_large">
                <p class="slds-text-body_regular">No attachments found. Upload files using the button above.</p>
            </div>
        </template>
    </div>
</template>
